FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1kZXYtYXBiCmRlc2NyaXB0aW9uOiBOdXhlbyBE\
ZXYgZW52aXJvbm1lbnQgd2l0aCBDSS9DRApiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBudXhlbwptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogTnV4ZW8gRGV2IGVudmly\
b25tZW50CiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgQSBmdWxsIGFuZCBtb2R1bGFyIE51eGVvIGRl\
dmVsb3BtZW50IGVudmlyb25tZW50IHRoYXQgYWxsb3dzCiAgICAgYSBjb21wbGV0ZSBDSS9DRCB3\
b3JrZmxvdy4KICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8v\
Z2l0aHViLmNvbS9udXhlby9udXhlby1vcGVuc2hpZnQvUkVBRE1FLm1kIgogIGltYWdlVXJsOiAi\
aHR0cHM6Ly93d3cubnV4ZW8uY29tL2Fzc2V0cy9pbWdzL2xvZ28zNDB4NjAucG5nIgpwbGFuczoK\
ICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZXZlbG9wbWVudCB3aXRoIEdpdCBS\
ZXBvc2l0b3J5CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFtZXRlcnM6\
CiAgICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
dGl0bGU6IFByb2plY3QgTmFtZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IFByb2plY3QgcHJvcGVy\
dGllcwoKICAgICAgLSBuYW1lOiBwcm9qZWN0X2dpdF9yZXBvCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IEFkZHJlc3Mgb2YgdGhlIEdpdCBSZXBvc2l0b3J5CiAgICAgICAgZGlz\
cGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IHByb2plY3RfZ2l0\
X3JlZgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6ICJtYXN0ZXIiCiAgICAg\
ICAgdGl0bGU6IEJyYW5jaCBvZiB0aGUgR2l0IFJlcG9zaXRvcnkKICAgICAgICBkaXNwbGF5X2dy\
b3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFtZTogcHJvamVjdF9naXRfc3NoCiAg\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFNTSCBrZXkgZm9yIGdpdCByZXBvIGFj\
Y2VzcyBpZiBuZWVkZWQKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgZGlz\
cGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IG51eGVvX2Nvbm5l\
Y3RfdXNlcm5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogfAogICAgICAg\
ICAgQSBOdXhlbyBDb25uZWN0IHVzZXJJZCB1c2VkIHRvIHJlZ2lzdGVyIHRoZSBpbnN0YW5jZSwg\
cHVsbAogICAgICAgICAgc3R1ZGlvIHByb2plY3QgZXRjLi4uCiAgICAgICAgZGlzcGxheV9ncm91\
cDogQ29ubmVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IG51eGVvX2Nvbm5lY3RfdG9rZW4K\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogfAogICAgICAgICAgQSB0b2tlbiBm\
b3IgdGhlIENvbm5lY3QgYWNjb3VudAogICAgICAgICAgKCBodHRwczovL2Nvbm5lY3QubnV4ZW8u\
Y29tL251eGVvL3NpdGUvY29ubmVjdC90b2tlbnMgKQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFz\
c3dvcmQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBDb25uZWN0IHByb3BlcnRpZXMKCiAgICAgIC0g\
bmFtZTogbnV4ZW9fc3R1ZGlvX3Byb2plY3QKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0\
aXRsZTogVGhlIG5hbWUgb2YgdGhlIHN0dWRpbyBwcm9qZWN0IHRvIHJlZ2lzdGVyIHRvCiAgICAg\
ICAgZGlzcGxheV9ncm91cDogQ29ubmVjdCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IG51eGVv\
X3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnOS4xMCcKICAgICAgICB0eXBlOiBlbnVtCiAgICAg\
ICAgZW51bTogWyc5LjEwJywgJzEwLjInLCAnbWFzdGVyJ10KICAgICAgICB0aXRsZTogTnV4ZW8g\
dmVyc2lvbiB0byB1c2UKICAgICAgICBkaXNwbGF5X2dyb3VwOiBOdXhlbyBDb25maWd1cmF0aW9u\
CgogICAgICAtIG5hbWU6IG51eGVvX3BhY2thZ2VzCiAgICAgICAgZGVmYXVsdDogJ251eGVvLXdl\
Yi11aScKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTGlzdCBvZiBOdXhlbyBw\
YWNrYWdlcyB0byBpbnN0YWxsIGF0IHN0YXJ0dXAKICAgICAgICBkaXNwbGF5X2dyb3VwOiBOdXhl\
byBDb25maWd1cmF0aW9uCgogICAgICAtIG5hbWU6IG51eGVvX3RlbXBsYXRlcwogICAgICAgIGRl\
ZmF1bHQ6ICcnCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IHwKICAgICAgICAg\
IENvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIE51eGVvIHRlbXBsYXRlcyB0byBiZSBhZGRlZCB0byB0\
aGUKICAgICAgICAgIGNvbmZpZ3VyYXRpb24KICAgICAgICBkaXNwbGF5X2dyb3VwOiBOdXhlbyBD\
b25maWd1cmF0aW9uCgogICAgICAtIG5hbWU6IGJhY2tlbmRfcmVwb3NpdG9yeV90eXBlCiAgICAg\
ICAgZGVmYXVsdDogJ0RCUycKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWydEQlMn\
LCAnVkNTX1Bvc3RncmVzJ10KICAgICAgICB0aXRsZTogUmVwb3NpdG9yeSB0eXBlCiAgICAgICAg\
ZGlzcGxheV9ncm91cDogQmFja2VuZCBzdG9yYWdlcwoKICAgICAgLSBuYW1lOiBiYWNrZW5kX3N0\
cmVhbV90eXBlCiAgICAgICAgZGVmYXVsdDogJ0Nocm9uaWNsZScKICAgICAgICB0eXBlOiBlbnVt\
CiAgICAgICAgZW51bTogWydDaHJvbmljbGUnLCAnS2Fma2EnXQogICAgICAgIHRpdGxlOiBTdHJl\
YW0gdHlwZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgICAgIC0g\
bmFtZTogYmFja2VuZF9wdWJzdWJfdHlwZQogICAgICAgIGRlZmF1bHQ6IGlubWVtb3J5CiAgICAg\
ICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsnaW5tZW1vcnknLCAnc3RyZWFtJywgJ3JlZGlz\
J10KICAgICAgICB0aXRsZTogU3RyZWFtIHR5cGUKICAgICAgICBkaXNwbGF5X2dyb3VwOiBCYWNr\
ZW5kIHN0b3JhZ2VzCgogICAgICAtIG5hbWU6IGJhY2tlbmRfYmluYXJpZXNfdHlwZQogICAgICAg\
IGRlZmF1bHQ6IGZzCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsnZnMnLCAnbWlu\
aW8nLCAnczMnXQogICAgICAgIHRpdGxlOiBCaW5hcmllcyBzdG9yYWdlIHR5cGUKICAgICAgICBk\
aXNwbGF5X2dyb3VwOiBCYWNrZW5kIHN0b3JhZ2VzCgogICAgICAjIFRPRE86IEsvViBzdG9yZSB0\
eXBlCgogICAgICAtIG5hbWU6IGJhY2tlbmRfcHZfc3RvcmFnZV9jbGFzcwogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHRpdGxlOiBTdG9yYWdlIGNsYXNzIGZvciBiYWNrZW5kIHBlcnNpc3Rl\
bmNlIHZvbHVtZXMKICAgICAgICBkZWZhdWx0OiBncDIKICAgICAgICBkaXNwbGF5X2dyb3VwOiBC\
YWNrZW5kIHN0b3JhZ2VzCgogICAgICAtIG5hbWU6IGJpbmFyaWVzX3B2X3N0b3JhZ2VfY2xhc3MK\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogU3RvcmFnZSBjbGFzcyBmb3IgYmFj\
a2VuZCBwZXJzaXN0ZW5jZSB2b2x1bWVzIChpZiBmcyB1c2VkKQogICAgICAgIGRlZmF1bHQ6IHNo\
YXJlZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgLSBuYW1lOiBz\
dHVkaW8tb25seQogICAgZGVzY3JpcHRpb246IERldmVsb3BtZW50IHdpdGggU3R1ZGlvIHByb2pl\
Y3Qgb25seQogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOgog\
ICAgICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRp\
dGxlOiBQcm9qZWN0IE5hbWUKCiAgICAgIC0gbmFtZTogbnV4ZW9fY29ubmVjdF91c2VybmFtZQog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8CiAgICAgICAgICBBIE51eGVvIENv\
bm5lY3QgdXNlcklkIHVzZWQgdG8gcmVnaXN0ZXIgdGhlIGluc3RhbmNlLCBwdWxsCiAgICAgICAg\
ICBzdHVkaW8gcHJvamVjdCBldGMuLi4KCiAgICAgIC0gbmFtZTogbnV4ZW9fY29ubmVjdF90b2tl\
bgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8CiAgICAgICAgICBBIHRva2Vu\
IGZvciB0aGUgQ29ubmVjdCBhY2NvdW50CiAgICAgICAgICAoIGh0dHBzOi8vY29ubmVjdC5udXhl\
by5jb20vbnV4ZW8vc2l0ZS9jb25uZWN0L3Rva2VucyApCiAgICAgICAgZGlzcGxheV90eXBlOiBw\
YXNzd29yZAoKICAgICAgLSBuYW1lOiBudXhlb19zdHVkaW9fcHJvamVjdAogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgc3R1ZGlvIHByb2plY3QgdG8g\
cmVnaXN0ZXIgdG8KCiAgICAgIC0gbmFtZTogbnV4ZW9fc3R1ZGlvX3ZlcnNpb24KICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogVGhlIG5hbWUgb2YgdGhlIHN0dWRpbyBwcm9qZWN0\
IHRvIHJlZ2lzdGVyIHRvCgogICAgICAtIG5hbWU6IGJhY2tlbmRfcHZfc3RvcmFnZV9jbGFzcwog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBTdG9yYWdlIGNsYXNzIGZvciBiYWNr\
ZW5kIHBlcnNpc3RlbmNlIHZvbHVtZXMKICAgICAgICBkZWZhdWx0OiBncDIKCiAgICAgIC0gbmFt\
ZTogYmluYXJpZXNfcHZfc3RvcmFnZV9jbGFzcwogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHRpdGxlOiBTdG9yYWdlIGNsYXNzIGZvciBiYWNrZW5kIHBlcnNpc3RlbmNlIHZvbHVtZXMKICAg\
ICAgICBkZWZhdWx0OiBzaGFyZWQK"




ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-dev-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb