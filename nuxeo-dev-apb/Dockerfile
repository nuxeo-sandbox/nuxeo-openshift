FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1kZXYtYXBiCmRlc2NyaXB0aW9uOiBOdXhlbyBE\
ZXYgZW52aXJvbm1lbnQgd2l0aCBDSS9DRApiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBudXhlbwptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogTnV4ZW8gRGV2IGVudmly\
b25tZW50CiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgQSBmdWxsIGFuZCBtb2R1bGFyIE51eGVvIGRl\
dmVsb3BtZW50IGVudmlyb25tZW50IHRoYXQgYWxsb3dzCiAgICAgYSBjb21wbGV0ZSBDSS9DRCB3\
b3JrZmxvdy4KICBkZXBlbmRlbmNpZXM6IFtdCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8v\
Z2l0aHViLmNvbS9udXhlby1zYW5kYm94L251eGVvLW9wZW5zaGlmdC9SRUFETUUubWQiCiAgaW1h\
Z2VVcmw6ICJodHRwczovL3d3dy5udXhlby5jb20vYXNzZXRzL2ltZ3MvbG9nbzM0MHg2MC5wbmci\
CnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERldmVsb3BtZW50IHdp\
dGggR2l0IFJlcG9zaXRvcnkKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFy\
YW1ldGVyczoKICAgICAgLSBuYW1lOiBwcm9qZWN0X25hbWUKICAgICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgICB0aXRsZTogUHJvamVjdCBOYW1lCiAgICAgICAgZGlzcGxheV9ncm91cDogUHJvamVj\
dCBwcm9wZXJ0aWVzCgogICAgICAtIG5hbWU6IHByb2plY3RfZ2l0X3JlcG8KICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICB0aXRsZTogQWRkcmVzcyBvZiB0aGUgR2l0IFJlcG9zaXRvcnkKICAg\
ICAgICBkaXNwbGF5X2dyb3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFtZTogcHJv\
amVjdF9naXRfcmVmCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogIm1hc3Rl\
ciIKICAgICAgICB0aXRsZTogQnJhbmNoIG9mIHRoZSBHaXQgUmVwb3NpdG9yeQogICAgICAgIGRp\
c3BsYXlfZ3JvdXA6IFByb2plY3QgcHJvcGVydGllcwoKICAgICAgLSBuYW1lOiBwcm9qZWN0X2dp\
dF9zc2gKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogU1NIIGtleSBmb3IgZ2l0\
IHJlcG8gYWNjZXNzIGlmIG5lZWRlZAogICAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFyZWEKICAg\
ICAgICBkaXNwbGF5X2dyb3VwOiBQcm9qZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFtZTogbnV4\
ZW9fY29ubmVjdF91c2VybmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8\
CiAgICAgICAgICBBIE51eGVvIENvbm5lY3QgdXNlcklkIHVzZWQgdG8gcmVnaXN0ZXIgdGhlIGlu\
c3RhbmNlLCBwdWxsCiAgICAgICAgICBzdHVkaW8gcHJvamVjdCBldGMuLi4KICAgICAgICBkaXNw\
bGF5X2dyb3VwOiBDb25uZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFtZTogbnV4ZW9fY29ubmVj\
dF90b2tlbgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiB8CiAgICAgICAgICBB\
IHRva2VuIGZvciB0aGUgQ29ubmVjdCBhY2NvdW50CiAgICAgICAgICAoIGh0dHBzOi8vY29ubmVj\
dC5udXhlby5jb20vbnV4ZW8vc2l0ZS9jb25uZWN0L3Rva2VucyApCiAgICAgICAgZGlzcGxheV90\
eXBlOiBwYXNzd29yZAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbm5lY3QgcHJvcGVydGllcwoK\
ICAgICAgLSBuYW1lOiBudXhlb19zdHVkaW9fcHJvamVjdAogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgc3R1ZGlvIHByb2plY3QgdG8gcmVnaXN0ZXIg\
dG8KICAgICAgICBkaXNwbGF5X2dyb3VwOiBDb25uZWN0IHByb3BlcnRpZXMKCiAgICAgIC0gbmFt\
ZTogbnV4ZW9fdmVyc2lvbgogICAgICAgIGRlZmF1bHQ6ICc5LjEwJwogICAgICAgIHR5cGU6IGVu\
dW0KICAgICAgICBlbnVtOiBbJzkuMTAnLCAnMTAuMicsICdtYXN0ZXInXQogICAgICAgIHRpdGxl\
OiBOdXhlbyB2ZXJzaW9uIHRvIHVzZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE51eGVvIENvbmZp\
Z3VyYXRpb24KCiAgICAgIC0gbmFtZTogbnV4ZW9fcGFja2FnZXMKICAgICAgICBkZWZhdWx0OiAn\
bnV4ZW8td2ViLXVpJwogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBMaXN0IG9m\
IE51eGVvIHBhY2thZ2VzIHRvIGluc3RhbGwgYXQgc3RhcnR1cAogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IE51eGVvIENvbmZpZ3VyYXRpb24KCiAgICAgIC0gbmFtZTogbnV4ZW9fdGVtcGxhdGVzCiAg\
ICAgICAgZGVmYXVsdDogJycKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogfAog\
ICAgICAgICAgQ29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgTnV4ZW8gdGVtcGxhdGVzIHRvIGJlIGFk\
ZGVkIHRvIHRoZQogICAgICAgICAgY29uZmlndXJhdGlvbgogICAgICAgIGRpc3BsYXlfZ3JvdXA6\
IE51eGVvIENvbmZpZ3VyYXRpb24KCiAgICAgIC0gbmFtZTogYmFja2VuZF9yZXBvc2l0b3J5X3R5\
cGUKICAgICAgICBkZWZhdWx0OiAnREJTJwogICAgICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVt\
OiBbJ0RCUycsICdWQ1NfUG9zdGdyZXMnXQogICAgICAgIHRpdGxlOiBSZXBvc2l0b3J5IHR5cGUK\
ICAgICAgICBkaXNwbGF5X2dyb3VwOiBCYWNrZW5kIHN0b3JhZ2VzCgogICAgICAtIG5hbWU6IGJh\
Y2tlbmRfc3RyZWFtX3R5cGUKICAgICAgICBkZWZhdWx0OiAnQ2hyb25pY2xlJwogICAgICAgIHR5\
cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0Nocm9uaWNsZScsICdLYWZrYSddCiAgICAgICAgdGl0\
bGU6IFN0cmVhbSB0eXBlCiAgICAgICAgZGlzcGxheV9ncm91cDogQmFja2VuZCBzdG9yYWdlcwoK\
ICAgICAgLSBuYW1lOiBiYWNrZW5kX3B1YnN1Yl90eXBlCiAgICAgICAgZGVmYXVsdDogaW5tZW1v\
cnkKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWydpbm1lbW9yeScsICdzdHJlYW0n\
LCAncmVkaXMnXQogICAgICAgIHRpdGxlOiBTdHJlYW0gdHlwZQogICAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgICAgIC0gbmFtZTogYmFja2VuZF9iaW5hcmllc190eXBl\
CiAgICAgICAgZGVmYXVsdDogZnMKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWydm\
cycsICdtaW5pbycsICdzMyddCiAgICAgICAgdGl0bGU6IEJpbmFyaWVzIHN0b3JhZ2UgdHlwZQog\
ICAgICAgIGRpc3BsYXlfZ3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgICAgICMgVE9ETzogSy9W\
IHN0b3JlIHR5cGUKCiAgICAgIC0gbmFtZTogYmFja2VuZF9wdl9zdG9yYWdlX2NsYXNzCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFN0b3JhZ2UgY2xhc3MgZm9yIGJhY2tlbmQg\
cGVyc2lzdGVuY2Ugdm9sdW1lcwogICAgICAgIGRlZmF1bHQ6IGdwMgogICAgICAgIGRpc3BsYXlf\
Z3JvdXA6IEJhY2tlbmQgc3RvcmFnZXMKCiAgICAgIC0gbmFtZTogYmluYXJpZXNfcHZfc3RvcmFn\
ZV9jbGFzcwogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBTdG9yYWdlIGNsYXNz\
IGZvciBiYWNrZW5kIHBlcnNpc3RlbmNlIHZvbHVtZXMgKGlmIGZzIHVzZWQpCiAgICAgICAgZGVm\
YXVsdDogc2hhcmVkCiAgICAgICAgZGlzcGxheV9ncm91cDogQmFja2VuZCBzdG9yYWdlcwoKICAt\
IG5hbWU6IHN0dWRpby1vbmx5CiAgICBkZXNjcmlwdGlvbjogRGV2ZWxvcG1lbnQgd2l0aCBTdHVk\
aW8gcHJvamVjdCBvbmx5CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToge30KICAgIHBhcmFt\
ZXRlcnM6CiAgICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAgICAgdGl0bGU6IFByb2plY3QgTmFtZQoKICAgICAgLSBuYW1lOiBudXhlb19jb25uZWN0X3Vz\
ZXJuYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IHwKICAgICAgICAgIEEg\
TnV4ZW8gQ29ubmVjdCB1c2VySWQgdXNlZCB0byByZWdpc3RlciB0aGUgaW5zdGFuY2UsIHB1bGwK\
ICAgICAgICAgIHN0dWRpbyBwcm9qZWN0IGV0Yy4uLgoKICAgICAgLSBuYW1lOiBudXhlb19jb25u\
ZWN0X3Rva2VuCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IHwKICAgICAgICAg\
IEEgdG9rZW4gZm9yIHRoZSBDb25uZWN0IGFjY291bnQKICAgICAgICAgICggaHR0cHM6Ly9jb25u\
ZWN0Lm51eGVvLmNvbS9udXhlby9zaXRlL2Nvbm5lY3QvdG9rZW5zICkKICAgICAgICBkaXNwbGF5\
X3R5cGU6IHBhc3N3b3JkCgogICAgICAtIG5hbWU6IG51eGVvX3N0dWRpb19wcm9qZWN0CiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFRoZSBuYW1lIG9mIHRoZSBzdHVkaW8gcHJv\
amVjdCB0byByZWdpc3RlciB0bwoKICAgICAgLSBuYW1lOiBudXhlb19zdHVkaW9fdmVyc2lvbgog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBUaGUgbmFtZSBvZiB0aGUgc3R1ZGlv\
IHByb2plY3QgdG8gcmVnaXN0ZXIgdG8KCiAgICAgIC0gbmFtZTogYmFja2VuZF9wdl9zdG9yYWdl\
X2NsYXNzCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFN0b3JhZ2UgY2xhc3Mg\
Zm9yIGJhY2tlbmQgcGVyc2lzdGVuY2Ugdm9sdW1lcwogICAgICAgIGRlZmF1bHQ6IGdwMgoKICAg\
ICAgLSBuYW1lOiBiaW5hcmllc19wdl9zdG9yYWdlX2NsYXNzCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgdGl0bGU6IFN0b3JhZ2UgY2xhc3MgZm9yIGJhY2tlbmQgcGVyc2lzdGVuY2Ugdm9s\
dW1lcwogICAgICAgIGRlZmF1bHQ6IHNoYXJlZAo="




ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-dev-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb